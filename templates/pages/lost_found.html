{% extends "base.html" %}
{% load static %}

{% block title %}Perdidos & Encontrados{% endblock %}

{% block navbar %}
{% include "components/navbar.html" %}
{% endblock navbar %}

{% block left_sidebar %}
{% include "components/sidebars/left/sidebar.html" %}
{% endblock left_sidebar %}

{% block content %}

<div class="pt-24 max-w-6xl mx-auto px-3">

    <!-- HEADER -->
    <div class="bg-white dark:bg-dark-second rounded-xl shadow p-5 mb-8">
    <h2 class="text-lg font-semibold mb-4 dark:text-dark-txt">
        üîç Buscar animal
    </h2>

    <form method="get" action="{% url 'lost_found:feed' %}" class="space-y-4">

        <div>
            <span class="block text-sm font-semibold mb-2 dark:text-dark-txt">
                Estado
            </span>
            {{ search_form.status }}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {{ search_form.animal_type }}
            {{ search_form.size }}
            {{ search_form.color }}
            {{ search_form.pattern }}
            {{ search_form.place }}
        </div>

        <div class="text-right">
            <button class="px-6 py-2 rounded-lg border hover:bg-gray-100">
                Buscar
            </button>
        </div>
    </form>
</div>


    <!-- ================= POSTS GRID ================= -->
<div class="bg-white dark:bg-dark-second rounded-xl shadow p-5 mb-10">
    <h2 class="text-lg font-semibold mb-4 dark:text-dark-txt">
        ‚ûï Publicar aviso
    </h2>

    <form method="post" enctype="multipart/form-data" class="space-y-4">
        {% csrf_token %}

        <div>
            <span class="block text-sm font-semibold mb-2 dark:text-dark-txt">
                Estado
            </span>
            {{ create_form.status }}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {{ create_form.animal_type }}
            {{ create_form.size }}
            {{ create_form.color }}
            {{ create_form.pattern }}
            {{ create_form.place }}
        </div>

        <div>
            <label class="text-sm font-semibold dark:text-dark-txt">
                Descripci√≥n
            </label>
            {{ create_form.description }}
        </div>

        <div>
            <input type="file" name="images" multiple accept="image/*">
        </div>

        <div class="text-right">
            <button class="px-6 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600">
                Publicar
            </button>
        </div>
    </form>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    {% for post in posts %}
        {% include "components/lost_found_item.html" with post=post %}
    {% empty %}
        <p>No hay publicaciones</p>
    {% endfor %}
</div>

{% endblock content %}

{% block right_sidebar %}
{% include 'components/sidebars/right/sidebar.html' %}

{% endblock %}

{% block javascript %}
<script>
document.addEventListener("DOMContentLoaded", () => {
    const animalSelect = document.getElementById("id_animal_type");
    const otherWrapper = document.getElementById("animal-other-wrapper");

    function toggleOther() {
        otherWrapper.classList.toggle("hidden", animalSelect.value !== "other");
    }

    animalSelect.addEventListener("change", toggleOther);
    toggleOther();
});
</script>
{% if highlight_id %}
<script>
    const el = document.getElementById("lostfoundpost-{{ highlight_id }}");
    if (el) {
        el.scrollIntoView({ behavior: "smooth", block: "center" });
    }
</script>
{% endif %}
{% endblock %}
